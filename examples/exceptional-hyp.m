R<x> := PolynomialRing(Rationals());
K<a> := NumberField(x^8 - 8*x^6 + 20*x^4 - 16*x^2 + 2);



rosens := [-a^6 + 4*a^4 - 3*a^2,
    -2*a^7 + 4*a^6 + 8*a^5 - 17*a^4 - 6*a^3 + 17*a^2 - 2*a - 1,
    1/2*(-a^4 + 5*a^2 - 4),
    1/2*(-a^6 + 6*a^4 - 10*a^2 + 6),
    1/2*(a^6 - 8*a^4 + 16*a^2 - 2),
    -a^2 + 4,
    -a^6 + 6*a^4 - 10*a^2 + 4];

_<x,y> := PolynomialRing(K, 2);
f := y*x*(x-y)*(&*[x-r*y : r in rosens]);

inv := InvariantsGenus4Curves(f);// : normalize := true);

invs := [ -170/7, 1582549448/19370043, -40784068715200/344534954841, 
-220398393800/38281661649, -40647258000/161801980813, 
-11025781805440/1624236215679, 608570164951040/11449842653290041, 
-1620233322127360/18495899670699297, 399123279098178560/347311893816464577, 
125101741761728/186827269401003, 91217293029392000/153011533639421457, 
291070716914095208704/5840362247171650285764061, 
-344206475665113840/813359928152286133619, 
3577444286236928/214165143250643565981, 523347200636363144192/88592325317101508\
93968665, 88882080610226586864/3137384678232704698964165, 
618075031626434048/7532616123722755900835, 
487595149282270208/32994629912564134815, 
-2558397368919208303616/63919628249875957215657, 
-16853941905120/1778657880454015561, 5863966020288/142833895725385865, 
50509502209836000/555953471054194213, 12622117212994560/18197038315414159201, 
-920755843740391168/234137832417128048409, 
-231445116257275713920/50501955902013681882783351, 
-317815726716315991360/2123821681351458207119, 
17286540499124806656/1975302682655552038789, 
-44847152814716305920/17569797545725699713439, 
-40078623418985556000/784539370034308737541, 
-695968370391505408/2294626534828323921225, 
-31408660618439708672/1865021455807687720417875, 
1446824164467601408/3317775010857886576322325, 
-8526407647910016000/239011624601321796693469, 
-21169110836474304512/11020217389006391882921605, 
-329883288646044800000/6377836509098428995978357, 
-98847174481937216289664/302360643867793414775897025, 
3929095185897003425152/2312841810991737987552591, 
-683423705241352565888/106639246463543055288121095, 
16338165130209383424/336688201837775286363865, 
-1421769812483285926112/216005158062157131771103, 
883553188531478286464/42608567105760250228008375, 
-49506772712994005504/1195058123006608983467345, 
-25439301892741138272000/1613797484160573073121837, 
20252927651652629431040/14881618521229667657282833, 
-122609549352040297495040/17358917886035214733191982419, 
3505486873741482690659072/4001877504098631530521119746775, 
4969419143673791185125632/2640711201290651130163682292825, 
-5745454206818752914183424/802501845587029044751041112365, 
12853854938790768726619968/79155152800591948663552983013, 
517605534994708981038016/45269334879268305088520267877, 
57745451482136646780656/6858990133222470467957616345, 
-109540222960528058274112/109787925072098014016448147975, 
66830901402537062899200/474225917845471258773088387, 
-174779145405672607293440/30611489298169426371030787481, 
-103795880674003724383488/530017202297879642158157609, 
-73235494749818315479680/4384687764464277039672031129, 
57669677843826476832220800/31438388788932124037486506597, 
365366300795705496628800/25970842912596102465749722841, 
-827010023005008971789040/2360985719326918405977247531, 
4210680808735180928803426752/177785696703139495555977882095375, 
381196636076915055954432/23007560749818052366067725918225, 
-2599037850247499218088153088/94694276349251141843499798252905, 
1748232764498692798246332288/66034687346880384063648927635425, 
381500338017750915227270948352/13689498646141741157810296921343875, 
-669270103570559233462930384896/176868322508151295758909036223762865, 
-744293695099758727907373921792/116947431291325160176722250842337675, 
-1009417858876940486217773952/6003153395170944005786266148675, 
113635460438779225709067904/13206937469376076812729785527085, 
-40946850643541548319131571712/207835489649655103526642414347285, 
4697238517006757453360128/63191088370220463218802801565, 
45036180029048412620692446336/462242811428162688445542493447975, 
-34843655052026532726392046720/789774860668689393401241174519683, 
-2155719388588936671991979824/933919149620165431757320547986725, 
-45319301347077598246598460176/21512069301079878962273323733540375, 
688843560464687132518219946944/833807806109856108577714027912024935, 
19970862022679127325169815119872/4961912441931938938926644071453469925, 
564996735786014185737344178560/15175302071199381176114395307998853817, 
-24497776950361550890743226955776/90306806443161288688464922100453152635, 
-22416613369373289260239588/288769536658783555939663846021275, 
16703634267764005129396209928/6711765621936922236229277004864597, 
157140859279070998063966768/6206851727093772322515112826661, 
69419696792299341097876559808/3982729858218503906947197397107475, 
-1935859368432037251375902747392/183774534886368108849134965609387775, 
-50386630240432475364755802805248/850597305433809048698008586953667875, 
-1917146325138452446199364528128/16723482674659497905271281870454287525, 
399374798682867908374732818714368/77404354794476623431518781412783776625, 
192983728285251203229809111776/125968567120961187948610371668484903, 
-479780845479735449272681223712/10355097631368110158062713232479435, 
-1792865803200635074404477382/198104062040641152190946782906275, 
-1963743104462269439950293216/279377523390647778730822386149875, 
7244908599318761721935655446912/1642348709004262032047012479220655175, 
261014274624924914505956288/273329821707838462108884583908513, 
-195704002676205452484191072/69022682249454157098203177754675, 
37781011107518657242810167808/1945551547589664253347999398461391515, 
-184056692526109056413050008258/4606113662113574083686758728828645, 
-158972571502313462312689074127/4665933320063101019838534816216030, 
-286282116662678822396845715258288024/43222979735557994300646374894854264801653\
5, 95050438178974322837711470961056272/1570304754403604392675280568935439581787\
5, 44631466095943343644227882956309436/2374888996459230456079471148068915648442\
5, -177481919477685347091290999907162/73525975122576794305865979816375097475, 
-119442354896480366252150973898761728/76151031570464902686047885951115968350549\
53, -715938083111175049832323435516296448/4069195097276223945586806544364223811\
1575, 52645402600786884666606454752009232264/2118142121941019510703175601722333\
2466050297675, -255532566322474565572736549963933834594384/97057468965288109189\
35712227025199138197443676125, -11083604550330921081604556395117185725541234904\
57/1262600360841069016326536769018990081803325099101815786275, 
101719001524321276059834703174571928089577287161/139496913539169890712942203582\
50239476003470408336700850 ];

//same as [ -20570/7, 1582549448/1323, -40784068715200/194481, -220398393800/21609, -40647258000/91333, -11025781805440/916839, 608570164951040/53414361, -1620233322127360/86284737, 399123279098178560/1620235617, 125101741761728/871563, 91217293029392000/713810097, 291070716914095208704/2476883719458071, -344206475665113840/344944008409, 3577444286236928/90826927191, 523347200636363144192/3757179417306315, 88882080610226586864/1330557369956815, 618075031626434048/290414959835, 487595149282270208/1272085815, -2558397368919208303616/2464378373457, -16853941905120/68574961, 5863966020288/5506865, 50509502209836000/21434413, 12622117212994560/701574601, -920755843740391168/9027027009, -231445116257275713920/177006274555341, -317815726716315991360/7443865429, 17286540499124806656/6923315399, -44847152814716305920/61581068549, -40078623418985556000/2749762631, -7655652074306559488/88467786225, -31408660618439708672/6536786426625, 1446824164467601408/11628599011575, -8526407647910016000/76156469389, -21169110836474304512/3511380878005, -329883288646044800000/2032175262117, -98847174481937216289664/96341419199025, 3929095185897003425152/736942677471, -683423705241352565888/33978550300695, 16338165130209383424/107279237065, -1421769812483285926112/68825900143, 883553188531478286464/13576402578375, -49506772712994005504/380782346945, -25439301892741138272000/514205611997, 20252927651652629431040/4741742278273, -122609549352040297495040/502826018235849, 3505486873741482690659072/115920136500693525, 4969419143673791185125632/76491997218558075, -5745454206818752914183424/23245619933951415, 12853854938790768726619968/2292842823894623, 517605534994708981038016/1311291380889567, 57745451482136646780656/198680512255995, -109540222960528058274112/3180165121858725, 66830901402537062899200/13736635634777, -174779145405672607293440/886705806037051, -103795880674003724383488/15352710415339, -73235494749818315479680/127008786163259, 57669677843826476832220800/910658138846687, 365366300795705496628800/752282810351611, -827010023005008971789040/68389346395601, 4210680808735180928803426752/468165305105180375, 381196636076915055954432/60586098307729225, -2599037850247499218088153088/249359625666548705, 1748232764498692798246332288/173889970467638425, 381500338017750915227270948352/36048728493098888875, -669270103570559233462930384896/465749572130837644265, -744293695099758727907373921792/307959137698187650675, -1009417858876940486217773952/15808179133421675, 113635460438779225709067904/34777994093527685, -40946850643541548319131571712/547295801787619885, 4697238517006757453360128/166401885614965, 45036180029048412620692446336/1217229793273468975, -34843655052026532726392046720/2079724046792955563, -2155719388588936671991979824/223572819172677975, -45319301347077598246598460176/5149818356156984125, 688843560464687132518219946944/199606959484644704685, 19970862022679127325169815119872/1187842388264438081175, 564996735786014185737344178560/3632846662620533625267, -24497776950361550890743226955776/21618731466412773077385, -22416613369373289260239588/69129131176130025, 16703634267764005129396209928/1606743327120979047, 157140859279070998063966768/1485870955079511, 69419696792299341097876559808/953433862842686225, -1935859368432037251375902747392/43994162528312521525, -50386630240432475364755802805248/203626232135687986625, -1917146325138452446199364528128/4003468790076439458775, 399374798682867908374732818714368/18529987124347606782875, 192983728285251203229809111776/30155873439183945453, -479780845479735449272681223712/2478928043390984185, -1792865803200635074404477382/47424537400265025, -1963743104462269439950293216/66880757872168625, 7244908599318761721935655446912/393165223227330478925, 261014274624924914505956288/5948453288395233, -195704002676205452484191072/1502134668786675, 37781011107518657242810167808/42340870193712513115, -184056692526109056413050008258/100242453563697445, -158972571502313462312689074127/101544303609979230, -286282116662678822396845715258288024/855143611465872670026085, 95050438178974322837711470961056272/31067642420728930641625, 44631466095943343644227882956309436/46985912717905091759675, -177481919477685347091290999907162/145467222036857869225, -119442354896480366252150973898761728/15066075627462374859186843, -715938083111175049832323435516296448/7318805061006074210575, 52645402600786884666606454752009232264/346333162643678431360564425, -255532566322474565572736549963933834594384/158696717452252712797276587375, -1108360455033092108160455639511718572554123490457/170615907618190415589511351427096025, 101719001524321276059834703174571928089577287161/1885029756966591127134769984807350 ];
//_, lambda := IsSquare(inv[1]/invs[1]);
lambda := 1/120*(154*a^7 - 242*a^6 - 748*a^5 + 1023*a^4 + 1034*a^3 - 1034*a^2 - 396*a + 154); //normalizing factor

C_24 := Transvectant(f, f, 8);
C_28 := Transvectant(f, f, 6);
c_3 := 1/lambda^3*Transvectant(C_28, f, 8);
c_5_1 := 1/lambda^2*Transvectant(C_24, c_3, 2);
c_5_2 := 1/lambda^5*Transvectant(C_28, Transvectant(C_24, f, 4), 6);
C := [c_3, c_5_1, c_5_2];

_<[X]> := PolynomialRing(Rationals(), 3);
Q := &+[Rationals()!(Evaluate(Transvectant(C[i], C[j], 2), [0,0]))*X[i]*X[j] : i in [1..3], j in [1..3]];
E := &+[Rationals()!(1/lambda*Evaluate(Transvectant(C[i1]*C[i2]*C[i3]*C[i4]*C[i5], f, 10), [0,0]))*X[i1]*X[i2]*X[i3]*X[i4]*X[i5] : i1 in [1..3], i2 in [1..3], i3 in [1..3], i4 in [1..3], i5 in [1..3]];

Con := Conic(ProjectiveSpace(Parent(Q)), Q);
p := Parametrization(Con);
f_rec := MinRedBinaryForm(E @@ p);

/* Check that the original one is geometrically isomorphic
inv_rec := InvariantsGenus4Curves(f_rec);
WPSEqual(wgt, inv_rec, invs);
*/

R<x,y> := PolynomialRing(RationalsExtra(), 2);
f_rec := x^9*y - 2*x^8*y^2 - 8*x^7*y^3 + 16*x^6*y^4 + 20*x^5*y^5 - 40*x^4*y^6 - 16*x^3*y^7 + 32*x^2*y^8 + 2*x*y^9 - 4*y^10;

Cur := HyperellipticCurve(UnivariatePolynomial(Evaluate(f_rec, [x, 1])));
End := GeometricEndomorphismRepresentation(Cur);